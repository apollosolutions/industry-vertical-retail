## Checking out with GraphQL

A large part of working in the retail domain is buying something. Once you have selected the thing you want, you will need to pay for it. The complexity of this tends to land outside of the schema. The schmea we have for a viewers cart and payments right now looks something like the following:

```graphql
type Query {
  viewer: User
}

type User @key(fields: "id") {
  id: ID!

  """
  Saved payment methods that can be used to submit orders
  """
  paymentMethods: [PaymentMethod]

  """
  The user's active cart session. Once the cart items have been purchases, they transition to an Order
  """
  cart: Cart
}

"""
An user's saved cart session. Only one cart can be active at a time
"""
type Cart {
  """
  Items saved in the cart session
  """
  items: [Variant]

  """
  The current total of all the items in the cart, before taxes and shipping
  """
  subtotal: Float
}

"""
A saved payment option for an user
"""
type PaymentMethod {
  id: ID!
  name: String
  description: String
  type: PaymentType!
}

"""
A fix set of payment types that we accept
"""
enum PaymentType {
  CREDIT_CARD
  DEBIT_CARD
  BANK_ACCOUNT
}
```

This is a great start and with the flowing few enhancements we can stat describing a basic checkout workflow.

schema additions:

```graphql
type Mutation {
    viewer: ViewerMutaitons
}

type ViewerMutaitons {
    checkout(paymentMethodId: String!):
}

type SuccessfulCheckout {
    successful: Boolean
    orderID: ID
}
```

This all hinges on our cart being set up. Lucky for us the cart is already set up for a few users. If you look at the schema, the user id is not supplied as a query variable, that is by design. The user is pulled from a header. In the real world this would come from your auth provider and be pulled out of a jwt or something similar. In our case, for this demo, the user id is pulled from the header `user-id`. Using the following queries we should be able to fetch what is currently in our cart:

query:

```graphql
query getCart {
  viewer {
    id
    username
    cart {
      items {
        product {
          title
          description
        }
        inventory {
          inStock
        }
        size
      }
      subtotal
    }
  }
}
```
